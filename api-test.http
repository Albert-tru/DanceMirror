### DanceMirror API 测试文件
### 使用 VS Code REST Client 插件运行

@baseUrl = http://localhost:8080/api/v1
@contentType = application/json

### 变量定义
@testEmail = test@dancemirror.com
@testPassword = Test123456

### ============================================
### 1. 用户注册
### ============================================
# @name register
POST {{baseUrl}}/register
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}",
  "firstName": "Test",
  "lastName": "User"
}

### ============================================
### 2. 用户登录
### ============================================
# @name login
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}"
}

### 从登录响应中提取 token
@token = {{login.response.body.token}}

### ============================================
### 3. 获取视频列表 (需要认证)
### ============================================
GET {{baseUrl}}/videos
Authorization: Bearer {{token}}

### ============================================
### 4. 上传视频 (需要认证)
### ============================================
# 注意：需要实际的视频文件
POST {{baseUrl}}/videos/upload
Authorization: Bearer {{token}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="title"

我的第一支舞蹈视频
------WebKitFormBoundary
Content-Disposition: form-data; name="description"

这是一个测试视频
------WebKitFormBoundary
Content-Disposition: form-data; name="video"; filename="test.mp4"
Content-Type: video/mp4

< ./test.mp4
------WebKitFormBoundary--

### ============================================
### 5. 获取特定视频详情
### ============================================
GET {{baseUrl}}/videos/1
Authorization: Bearer {{token}}

### ============================================
### 6. 删除视频
### ============================================
DELETE {{baseUrl}}/videos/1
Authorization: Bearer {{token}}

### ============================================
### 7. 测试未授权访问 (应该失败)
### ============================================
GET {{baseUrl}}/videos

### ============================================
### 8. 测试错误密码 (应该失败)
### ============================================
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "WrongPassword"
}

### ============================================
### 9. 注册已存在用户 (应该失败)
### ============================================
POST {{baseUrl}}/register
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}",
  "firstName": "Duplicate",
  "lastName": "User"
}

### ============================================
### 10. 无效 token (应该失败)
### ============================================
GET {{baseUrl}}/videos
Authorization: Bearer invalid_token

